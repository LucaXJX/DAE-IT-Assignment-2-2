<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>主題清單</title>
    <!-- Ionic CDN -->
    <script
      type="module"
      src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js"
    ></script>
    <script
      nomodule
      src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.js"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css"
    />
    <style>
      .list-item:hover {
        transform: translateY(-2px); /* 滑鼠懸停時輕微上浮 */
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
      }

      .list-item {
        --background: #ffffff;
        border-radius: 12px; /* 更圓潤的邊角 */
        margin: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* 添加輕微陰影，更有層次感 */
        overflow: hidden; /* 確保圖片和內容都在圓角內 */
        transition: transform 0.2s ease; /* 添加點擊時的輕微縮放動畫 */
      }
      .item-content {
        width: 100%;
        max-width: 95%;
      }
      .item-title {
        font-size: 1.2rem;
        font-weight: bold;
        margin: 0.25rem 0;
      }
      .item-subtitle {
        color: var(--ion-color-medium);
        font-size: 0.9em;
        margin-bottom: 0.15rem;
      }
      .item-details p {
        margin: 6px 0;
        font-size: 0.9rem;
        line-height: 1.5; /* 增加行高，提高可讀性 */
      }
      .tag-container {
        display: flex;
        flex-wrap: wrap;
        width: 100%;
        gap: 0.5rem;
        margin: 1rem auto;
      }
      /* 響應式設計：針對不同螢幕尺寸的優化 */

      /* 大螢幕 (例如 iPad, 桌面瀏覽器) */
      @media (min-width: 768px) {
        .list-item {
          max-width: 800px; /* 限制最大寬度，避免在超寬螢幕上內容過散 */
          margin: 15px auto; /* 水平置中 */
        }
        .item-title {
          font-size: 1.4rem;
        }
        .item-details p {
          font-size: 1rem;
        }
      }

      /* 小螢幕 (例如 iPhone SE) */
      @media (max-width: 375px) {
        .item-title {
          font-size: 1.1rem;
        }
        .item-subtitle,
        .item-details p {
          font-size: 0.85rem;
        }
        .tag-container {
          gap: 4px;
        }
        ion-chip {
          font-size: 0.75rem; /* 縮小標籤字體 */
        }
      }
      /* 圖片容器和載入失敗文字的樣式 */
      .image-container {
        position: relative; /* 關鍵：讓子元素可以絕對定位 */
        width: 100%;
        max-height: 200px;
        border-radius: 8px;
        overflow: hidden; /* 隱藏超出容器的內容 */
        margin-bottom: 0.5rem;
        background-color: #f0f0f0; /* 給容器一個淺灰色背景 */
      }

      .item-image {
        width: 100%;
        height: 100%;
        object-fit: cover; /* 保持圖片比例並填滿容器 */
        display: block; /* 消除圖片底部的小空隙 */
      }

      .image-fallback-text {
        /* 絕對定位，讓文字覆蓋在圖片（或背景）上 */
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;

        /* 文字樣式 */
        color: #666;
        font-size: 1rem;
        text-align: center;

        /* 垂直置中技巧 */
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .image-fallback-text {
        /* 預設隱藏失敗提示文字 */
        display: none;
      }

      .image-container.error .image-fallback-text {
        /* 圖片載入失敗時顯示文字 */
        display: flex;
      }

      .image-container.error .item-image {
        /* 圖片載入失敗時隱藏圖片（避免破碎圖標） */
        display: none;
      }
    </style>
  </head>
  <body>
    <ion-app>
      <ion-header>
        <ion-toolbar>
          <ion-title>主題清單</ion-title>
        </ion-toolbar>
        <ion-searchbar placeholder="搜尋..."></ion-searchbar>
        <ion-item>
          <ion-select label="分類" interface="popover">
            <ion-select-option value="">全部</ion-select-option>
            <!-- 根據主題加入分類選項 -->
          </ion-select>
        </ion-item>
      </ion-header>

      <ion-content>
        <ion-list>
          <!-- 清單項目範本 -->
          <ion-item class="list-item">
            <div class="item-content">
              <div class="item-title">標題</div>
              <div class="item-subtitle">副標題</div>
              <div class="item-details">詳細資訊</div>
              <div class="tag-container">
                <ion-chip size="small">分類</ion-chip>
                <!-- 標籤 -->
              </div>
            </div>
          </ion-item>
        </ion-list>
      </ion-content>
    </ion-app>
  </body>
  <script>
    // 初始化資料
    let items = [
      {
        name: "故宮博物院",
        area: "北京市",
        openTime: "08:30-17:00（週一閉館，法定節假日除外）",
        feature:
          "世界上現存規模最大、保存最為完整的木質結構古建築之一，收藏了大量珍貴的中國歷代文物。",
        image: "img/1-gugong.jpeg", // 示例圖片
        video: "https://www.youtube.com/watch?v=-3sKZYrLcu8", // 示例影片鏈接
      },
      {
        name: "八達嶺長城",
        area: "北京市",
        openTime: "07:30-17:30（季節性調整）",
        feature:
          "明長城中保存最好的一段，也是最具代表性的一段，是觀賞長城壯麗景觀的絕佳地點。",
        image: "img/2-changcheng.jpeg",
        video: "https://www.youtube.com/watch?v=NukprmpYw6k",
      },
      {
        name: "頤和園",
        area: "北京市",
        openTime: "06:30-18:00（園內景點開放時間不同）",
        feature: "保存最完整的一座皇家行宮御苑，被譽為「皇家園林博物館」。",
        image: "img/3-yiheyuan.jpg",
        video: "https://www.youtube.com/watch?v=nFfDvCWrvHk",
      },
      {
        name: "廣州塔",
        area: "廣東省廣州市",
        openTime: "09:30-22:30（視季節及活動調整）",
        feature:
          "又稱小蠻腰，是中國第二高塔，擁有觀光平台、摩天輪、空中步道等多種娛樂設施，夜景燈光秀尤為著名。",
        image: "img/4-guangzhouta.jpeg",
        video: "https://www.youtube.com/watch?v=-UIKvs8N5pA",
      },
      {
        name: "上海迪士尼樂園",
        area: "上海市",
        openTime: "08:30-21:30（平日），08:00-22:00（週末及節假日）",
        feature:
          "中國大陸首座迪士尼主題樂園，包含六大主題園區和眾多精彩的遊樂設施與表演。",
        image: "img/5-shanghai-disneyland.jpg",
        video: "https://www.youtube.com/watch?v=8ymmpDRZQjs",
      },
      {
        name: "上海灘",
        area: "上海市",
        openTime: "全天開放",
        feature:
          "上海的地標之一，是黃浦江兩岸風景的觀賞點，一邊是近代建築群「萬國建築博覽群」，一邊是現代摩天大樓。",
        image: "img/6-shanghai-bund.jpg",
        video: "https://www.youtube.com/shorts/VL1IYwNxbog",
      },
      {
        name: "杭州西湖",
        area: "浙江省杭州市",
        openTime: "全天開放（景點及遊船有單獨時間）",
        feature:
          "中國大陸首批國家重點風景名勝區和中國十大風景名勝之一，以其秀麗的湖光山色和眾多的名勝古蹟聞名於世。",
        image: "img/7-hangzhouxihu.jpeg",
        video: "https://www.youtube.com/watch?v=ZNgGk0_DT3c",
      },
      {
        name: "蘇州園林（拙政園）",
        area: "江蘇省蘇州市",
        openTime:
          "07:30-17:30（3月1日-11月15日），07:30-17:00（11月16日-2月29日）",
        feature:
          "中國園林藝術的傑出代表，被譽為「咫尺山林，多方勝景」，以其佈局精巧、古樸典雅著稱。",
        image: "img/8-suzhouyuanlin.png",
        video: "https://www.youtube.com/watch?v=MjMsRDQC3V4",
      },
      {
        name: "香港迪士尼樂園",
        area: "香港特別行政區",
        openTime: "10:30-19:30（時間會浮動）",
        feature: "亞洲第二座、中國第一座迪士尼主題樂園，包含七大主題園區。",
        image: "img/9-hongkong-disneyland.jpg",
        video: "https://www.youtube.com/watch?v=i78E0OcMRvY",
      },
      {
        name: "香港海洋公園",
        area: "香港特別行政區",
        openTime: "10:00-19:00（平日），10:00-20:00（週末及公眾假期）",
        feature:
          "集海洋動物展示、動物表演、機動遊戲和園林於一身的大型主題公園。",
        image: "img/10-hongkong-oceanpark.jpg",
        video: "https://www.youtube.com/watch?v=GygLzhbUbrg",
      },
      {
        name: "太平山頂",
        area: "香港特別行政區",
        openTime: "纜車服務 07:00-22:00；凌霄閣 10:00-23:00",
        feature:
          "香港的地標之一，是香港島的最高峰，可俯瞰香港島、九龍半島和維多利亞港的壯麗景色。",
        image: "img/11-hongkong-victoriapeak.jpg",
        video: "https://www.youtube.com/watch?v=ZXP9q7fT7pU",
      },
      {
        name: "黃山",
        area: "安徽省黃山市",
        openTime:
          "06:30-17:00（3月1日-11月30日），07:00-16:30（12月1日-2月28日）",
        feature:
          "中國十大風景名勝唯一的山嶽風景，以奇松、怪石、雲海、溫泉「四絕」著稱。",
        image: "img/12-huangshan-mountain.jpg",
        video: "https://www.youtube.com/watch?v=mixa1JFC8vY",
      },
      {
        name: "張家界國家森林公園",
        area: "湖南省張家界市",
        openTime:
          "07:00-18:00（4月1日-10月31日），07:30-17:30（11月1日-3月31日）",
        feature:
          "中國第一個國家森林公園，以奇特的石英砂岩峰林地貌聞名，是電影《阿凡達》「哈利路亚山」的取景地。",
        image: "img/13-zhangjiajie.jpg",
        video: "https://www.youtube.com/watch?v=RoAFoGnapWQ",
      },
      {
        name: "九寨溝風景名勝區",
        area: "四川省阿壩藏族羌族自治州",
        openTime:
          "08:30-17:00（4月1日-11月15日），08:30-17:30（11月16日-3月31日）",
        feature:
          "以典型的高山湖泊、瀑布、鈣華灘流等地表水景為主，景觀奇特、色彩繽紛，被譽為「人間仙境」。",
        image: "img/14-jiuzhaigou.jpg",
        video: "https://www.youtube.com/watch?v=DKLP_By5gBo",
      },
      {
        name: "麗江古城",
        area: "雲南省麗江市",
        openTime: "全天開放（景點有單獨時間）",
        feature:
          "中國歷史上保存最完整的少數民族古城，已有800多年曆史，整個古城依山傍水，呈現出獨特的水鄉風貌。",
        image: "img/15-lijiang.jpg",
        video: "https://www.youtube.com/watch?v=d2f2GwwmMsg",
      },
      {
        name: "鼓浪嶼",
        area: "福建省廈門市",
        openTime: "全天開放（島上景點有單獨時間）",
        feature:
          "有「海上花園」之譽，是一座風格獨特的「建築博覽島」，融合了中西建築風格。",
        image: "img/16-gulangyu.jpg",
        video: "https://www.youtube.com/watch?v=myaZNoLwO9M",
      },
      {
        name: "秦始皇兵馬俑博物館",
        area: "陝西省西安市",
        openTime:
          "08:30-18:00（3月16日-11月15日），08:30-17:30（11月16日-3月15日）",
        feature:
          "世界八大奇蹟之一，是中國歷史上第一位皇帝秦始皇的陪葬坑，出土了成千上萬件與真人真馬大小相當的陶俑。",
        image: "img/17-bingmayong.jpg",
        video: "https://www.youtube.com/watch?v=d5GFkUCUyf0",
      },
      {
        name: "布達拉宮",
        area: "西藏自治區拉薩市",
        openTime: "09:30-15:00（週一閉館）",
        feature:
          "世界上海拔最高的宮殿式建築群，是一座巨大的宮堡式建築，雄偉壯觀，是藏族建築藝術的傑作。",
        image: "img/18-potala-palace.jpg",
        video: "https://www.youtube.com/watch?v=Z4WkevnpXTY",
      },
      {
        name: "桂林山水",
        area: "廣西壯族自治區桂林市",
        openTime: "全天開放（景點及遊船有單獨時間）",
        feature:
          "以「山青、水秀、洞奇、石美」著稱，素有「桂林山水甲天下」的美譽。",
        image: "img/19-guilin.jpg",
        video: "https://www.youtube.com/watch?v=PJnElCNkMIg",
      },
      {
        name: "三亞亞龍灣",
        area: "海南省三亞市",
        openTime: "全天開放",
        feature:
          "號稱「天下第一灣」，擁有潔白的沙灘、清澈的海水和絢麗的海底珊瑚景觀，是理想的熱帶海濱度假勝地。",
        image: "img/20-sanya-yalongbay.jpg",
        video: "https://www.youtube.com/watch?v=kAN3Y9CQkoM",
      },
    ];

    // 初始化分類選項（地區）
    function populateCategories() {
      const categorySelect = document.querySelector("ion-select");
      // 取得所有唯一地區
      const areas = Array.from(new Set(items.map((item) => item.area)));
      areas.forEach((area) => {
        const option = document.createElement("ion-select-option");
        option.value = area;
        option.textContent = area;
        categorySelect.appendChild(option);
      });
    }

    // 根據搜尋和分類過濾資料
    function getFilteredItems() {
      const searchbar = document.querySelector("ion-searchbar");
      const categorySelect = document.querySelector("ion-select");
      const keyword = (searchbar.value || "").trim();
      const category = categorySelect.value;

      return items.filter((item) => {
        // 搜尋條件：標題、副標題、詳細資訊
        const matchKeyword =
          !keyword ||
          item.name.includes(keyword) ||
          item.area.includes(keyword) ||
          item.feature.includes(keyword);
        // 分類條件
        const matchCategory = !category || item.area === category;
        return matchKeyword && matchCategory;
      });
    }

    // 更新清單顯示
    function updateList() {
      const list = document.querySelector("ion-list");
      list.innerHTML = ""; // 清空列表

      // 取得搜尋和分類條件
      const searchbar = document.querySelector("ion-searchbar");
      const categorySelect = document.querySelector("ion-select");
      const currentSearch = (searchbar.value || "").trim().toLowerCase();
      const currentArea = categorySelect.value;

      // 過濾資料：同時滿足搜尋和地區條件
      const filteredItems = items.filter((item) => {
        // 地區過濾：如果有選中地區，只顯示該地區景點
        const matchArea = currentArea ? item.area === currentArea : true;
        // 搜尋過濾：名稱/地區/特色包含搜尋詞（不分大小寫）
        const matchSearch = currentSearch
          ? item.name.toLowerCase().includes(currentSearch) ||
            item.area.toLowerCase().includes(currentSearch) ||
            item.feature.toLowerCase().includes(currentSearch)
          : true;
        return matchArea && matchSearch;
      });

      // 渲染過濾後的景點
      filteredItems.forEach((item) => {
        const listItem = document.createElement("ion-item");
        listItem.className = "list-item";
        listItem.innerHTML = `
      <div class="item-content">
        <!-- 景點圖片 -->
        <div class="image-container">
          <img src="${item.image}" alt="${item.name}" class="item-image" 
               onload="this.parentElement.classList.remove('error')"
               onerror="this.parentElement.classList.add('error')">
          <div class="image-fallback-text">圖片載入失敗</div>
        </div>
        <!-- 景點名稱 -->
        <div class="item-title">${item.name}</div>
        <!-- 地區 -->
        <div class="item-subtitle">地區：${item.area}</div>
        <!-- 開放時間和特色 -->
        <div class="item-details">
          <p>開放時間：${item.openTime}</p>
          <p>特色：${item.feature}</p>
        </div>
        <!-- 標籤（地區）和影片按鈕 -->
        <div class="tag-container">
          <ion-chip size="small" onclick="filterByArea('${item.area}')">${item.area}</ion-chip>
          <!-- 導覽影片按鈕 -->
          <a href="${item.video}" target="_blank" style="text-decoration:none;">
            <ion-chip size="small" color="primary">
              <ion-icon name="play" slot="start"></ion-icon>
              導覽影片
            </ion-chip>
          </a>
        </div>
      </div>
    `;
        list.appendChild(listItem);
      });

      // 如果沒有結果顯示提示
      if (filteredItems.length === 0) {
        const emptyItem = document.createElement("ion-item");
        emptyItem.innerHTML = `<div class="item-content" style="text-align:center; padding:1rem;">沒有找到符合條件的景點</div>`;
        list.appendChild(emptyItem);
      }
    }

    // 初始化分類選項
    populateCategories();

    // 初始顯示
    updateList();

    // 監聽搜尋框輸入事件
    const searchbar = document.querySelector("ion-searchbar");
    searchbar.addEventListener("ionInput", (event) => {
      // 執行搜尋邏輯
      updateList();
    });

    // 監聽分類選單變更事件
    const categorySelect = document.querySelector("ion-select");
    categorySelect.addEventListener("ionChange", (event) => {
      // 執行分類過濾邏輯
      updateList();
    });

    // 點擊標籤過濾（地區）
    function filterByArea(area) {
      // 1. 更新目前選中的地區
      currentArea = area;

      // 2. 更新分類選單的值
      const categorySelect = document.querySelector("ion-select");
      categorySelect.value = area;

      // 3. 更新清單顯示
      updateList();
    }
  </script>
</html>
